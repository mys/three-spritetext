{"version":3,"file":"three-spritetext.js","sources":["../src/index.js"],"sourcesContent":["export default class extends THREE.Sprite {\n  constructor(text = '', textHeight = 10, color = 'rgba(255, 255, 255, 1)') {\n    super(new THREE.SpriteMaterial({ map: new THREE.Texture() }));\n\n    this._text = text;\n    this._textHeight = textHeight;\n    this._color = color;\n\n    this._fontFace = 'Arial';\n    this._fontSize = 90; // defines text resolution\n\n    this._canvas = document.createElement('canvas');\n    this._texture = this.material.map;\n    this._texture.minFilter = THREE.LinearFilter;\n\n    this._genCanvas();\n  }\n\n  get text() { return this._text; }\n  set text(text) { this._text = text; this._genCanvas(); }\n  get textHeight() { return this._textHeight; }\n  set textHeight(textHeight) { this._textHeight = textHeight; this._genCanvas(); }\n  get color() { return this._color; }\n  set color(color) { this._color = color; this._genCanvas(); }\n  get fontFace() { return this._fontFace; }\n  set fontFace(fontFace) { this._fontFace = fontFace; this._genCanvas(); }\n  get fontSize() { return this._fontSize; }\n  set fontSize(fontSize) { this._fontSize = fontSize; this._genCanvas(); }\n\n  _genCanvas() {\n    const canvas = this._canvas;\n    const ctx = canvas.getContext('2d');\n    const expandVertically = 7; // set text above 3d object\n\n    const font = `bold ${this.fontSize}px ${this.fontFace}`;\n\n    ctx.font = font;\n    const textWidth = ctx.measureText(this.text).width;\n    canvas.width = textWidth;\n    canvas.height = this.fontSize * expandVertically;\n\n    ctx.font = font;\n    ctx.fillStyle = this.color;\n    ctx.textBaseline = 'top';\n    ctx.fillText(this.text, 0, 0);\n\n    // Inject canvas into sprite\n    this._texture.image = canvas;\n    this._texture.needsUpdate = true;\n\n    this.scale.set(this.textHeight * canvas.width / canvas.height * expandVertically, this.textHeight * expandVertically);\n  }\n\n  clone() {\n    return new this.constructor(this.text, this.textHeight, this.color).copy(this);\n  }\n\n  copy(source) {\n    THREE.Sprite.prototype.copy.call(this, source);\n\n    this.color = source.color;\n    this.fontFace = source.fontFace;\n    this.fontSize = source.fontSize;\n\n    return this;\n  }\n}"],"names":["text","textHeight","color","THREE","SpriteMaterial","map","Texture","_text","_textHeight","_color","_fontFace","_fontSize","_canvas","document","createElement","_texture","material","minFilter","LinearFilter","_genCanvas","canvas","ctx","getContext","expandVertically","font","fontSize","fontFace","textWidth","measureText","width","height","fillStyle","textBaseline","fillText","image","needsUpdate","scale","set","constructor","copy","source","Sprite","prototype","call"],"mappings":"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"}